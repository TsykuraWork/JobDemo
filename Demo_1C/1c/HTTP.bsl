Процедура ПолучитьСписокЗаказов(Ответ)
    Попытка
        Соединение = Новый HTTPСоединение("dummyjson.com");
        HTTPЗапрос = Новый HTTPЗапрос("/carts");
        HTTPОтвет = Соединение.Отправить(HTTPЗапрос);

        Если HTTPОтвет.КодСостояния <> 200 Тогда
            Ответ.КодСостояния = HTTPОтвет.КодСостояния;
            Ответ.УстановитьТело("{""error"":""Не удалось получить данные с DummyJSON""}");
            Возврат;
        КонецЕсли;

        ДанныеJSON = JSONВЗначение(HTTPОтвет.ПолучитьТелоКакСтроку());
        МассивРезультата = Новый Массив;

        Для Каждого Корзина Из ДанныеJSON.carts Цикл
            Заказ = Новый Структура;
            Заказ.Вставить("НомерЗаказа", Корзина.id);
            Заказ.Вставить("Пользователь", Корзина.userId);
            Заказ.Вставить("Сумма", Корзина.total);
            Заказ.Вставить("КоличествоПозиций", Корзина.totalProducts);

            Товары = Новый Массив;
            Для Каждого Товар Из Корзина.products Цикл
                Товары.Добавить(Товар.title + " (" + Строка(Товар.quantity) + " шт.)");
            КонецЦикла;

            Заказ.Вставить("Товары", Товары);
            МассивРезультата.Добавить(Заказ);
        КонецЦикла;

        Ответ.УстановитьТело(МассивВJSON(МассивРезультата));

    Исключение
        Ответ.КодСостояния = 500;
        Ответ.УстановитьТело("{""error"":""Ошибка при обработке DummyJSON""}");
    КонецПопытки;
КонецПроцедуры

